import os
import re

from Applications.triphoton.CutsAndFilters import D4Cut, SmallPTACut
from CutAndExport.CutEvent import CutEvents
from CutAndExport.CutFunctions import PhotonNumberCut
from Interfaces.LHCOlympics import LoadLHCOlympics

threePhotn = PhotonNumberCut(1, [3])

ptacutv = 0.12
ptaCut3 = SmallPTACut(1500, ptacutv)
ptaCut10 = SmallPTACut(5000, ptacutv)
ptaCut14 = SmallPTACut(7000, ptacutv)
ptaCut30 = SmallPTACut(15000, ptacutv)

d4cutv = 0.00003
d4Cut3 = D4Cut(1500, d4cutv)
d4Cut10 = D4Cut(5000, d4cutv)
d4Cut14 = D4Cut(7000, d4cutv)
d4Cut30 = D4Cut(15000, d4cutv)

os.chdir("../../")
ptacuts = [ptaCut3, ptaCut10, ptaCut14, ptaCut30]
d4cuts = [d4Cut3, d4Cut10, d4Cut14, d4Cut30]
energyhead = ["1500", "5000", "7000", "15000"]


def LogTxt(fileName: str) -> [list, list]:
    lineNumber = 0
    lstA = []
    lstB = []
    with open(fileName) as f:
        for lines in f.readlines():
            lineNumber = lineNumber + 1
            if 1 == lineNumber:
                continue
            linesrep = re.sub("[\\s]+", " ", lines)
            contentList = linesrep.split(' ')
            if 3 <= len(contentList):
                lstA.append(float(contentList[1]))
                lstB.append(float(contentList[2]))
    return [lstA, lstB]


for head in ["FT0", "FT2", "FT5", "FT7", "FT8", "FT9"]:
    for em in range(0, 4):
        [coeff, cs] = LogTxt("_DataFolder/triphoton/cs/{}-{}.txt".format(head, energyhead[em]))
        csaftercut = []
        for i in range(0, 11):
            events = LoadLHCOlympics(
                "_DataFolder/triphoton/cs/{}/{}-{}-{}.lhco".format(head, head, energyhead[em], i))
            beforecut = events.GetEventCount()
            CutEvents(events, threePhotn)
            CutEvents(events, ptacuts[em])
            CutEvents(events, d4cuts[em])
            aftercut = events.GetEventCount()
            csnow = cs[i] * aftercut / beforecut
            # print("cs = ", csnow)
            csaftercut.append(csnow)
        print("--------{} {}--------".format(head, energyhead[em]))
        print(coeff)
        print(csaftercut)

"""
--------FT0 1500--------
[-4.6e-13, -3.68e-13, -2.76e-13, -1.84e-13, -9.2e-14, 0.0, 9.2e-14, 1.84e-13, 2.76e-13, 3.68e-13, 4.6e-13]
[0.0007565124, 0.000713925139, 0.0006788494629999999, 0.000672085284, 0.0006698032410000001, 0.0006867938839999999, 0.000717269184, 0.000760740093, 0.00081712046, 0.000893924315, 0.0009800055609999999]
--------FT0 5000--------
[-4.3e-15, -3.44e-15, -2.58e-15, -1.72e-15, -8.6e-16, 0.0, 8.6e-16, 1.72e-15, 2.58e-15, 3.44e-15, 4.3e-15]
[7.07977914e-05, 6.586246099999999e-05, 6.227429895e-05, 6.000353550000001e-05, 5.997996105e-05, 6.153338369999999e-05, 6.46729892e-05, 6.96109064e-05, 7.617701299999999e-05, 8.42868325e-05, 9.443893765000001e-05]
--------FT0 7000--------
[-1.6e-15, -1.28e-15, -9.6e-16, -6.4e-16, -3.2e-16, 1.972152e-31, 3.2e-16, 6.4e-16, 9.6e-16, 1.28e-15, 1.6e-15]
[4.527162798e-05, 3.8696857050000004e-05, 3.42427767e-05, 3.143791928e-05, 3.0498153205000002e-05, 3.1365095640000004e-05, 3.395661519e-05, 3.815183342e-05, 4.44147873e-05, 5.233334595e-05, 6.19387418e-05]
--------FT0 15000--------
[-1.2e-16, -9.6e-17, -7.2e-17, -4.8e-17, -2.4e-17, 0.0, 2.4e-17, 4.8e-17, 7.2e-17, 9.6e-17, 1.2e-16]
[1.597549965e-05, 1.2226660455e-05, 9.45572494e-06, 7.60091426e-06, 6.6871796e-06, 6.78969032e-06, 7.8604506e-06, 9.925314509999999e-06, 1.289670018e-05, 1.696043998e-05, 2.1829999295000003e-05]
--------FT2 1500--------
[-9.3e-13, -7.44e-13, -5.58e-13, -3.72e-13, -1.86e-13, -2.019484e-28, 1.86e-13, 3.72e-13, 5.58e-13, 7.44e-13, 9.3e-13]
[0.000702637926, 0.0006710824884999999, 0.000649319098, 0.0006480238274999999, 0.000659277, 0.0006887329179999999, 0.000729416001, 0.00078358464, 0.000858869696, 0.0009434310139999999, 0.001047818541]
--------FT2 5000--------
[-8.6e-15, -6.88e-15, -5.16e-15, -3.44e-15, -1.72e-15, 0.0, 1.72e-15, 3.44e-15, 5.16e-15, 6.88e-15, 8.6e-15]
[6.62174865e-05, 6.13129755e-05, 5.9103671549999996e-05, 5.816400975e-05, 5.85725364e-05, 6.15264618e-05, 6.6347856e-05, 7.1823077e-05, 8.01480855e-05, 8.947174479999999e-05, 0.0001010506301]
--------FT2 7000--------
[-3.3e-15, -2.64e-15, -1.98e-15, -1.32e-15, -6.6e-16, 0.0, 6.6e-16, 1.32e-15, 1.98e-15, 2.64e-15, 3.3e-15]
[4.2440892e-05, 3.642121098e-05, 3.222250314e-05, 2.9953450865e-05, 2.974077383e-05, 3.1336834200000004e-05, 3.475034568e-05, 4.0474954875e-05, 4.76899622e-05, 5.720581859999999e-05, 6.90702831e-05]
--------FT2 15000--------
[-2.3e-16, -1.84e-16, -1.38e-16, -9.2e-17, -4.6e-17, 0.0, 4.6e-17, 9.2e-17, 1.38e-16, 1.84e-16, 2.3e-16]
[1.4044001725e-05, 1.0779015750000001e-05, 8.4381501e-06, 6.970261339999999e-06, 6.418498345e-06, 6.8066064500000005e-06, 8.13750753e-06, 1.0327472899999998e-05, 1.3425727249999999e-05, 1.752904188e-05, 2.24350227e-05]
--------FT5 1500--------
[-9.7e-14, -7.76e-14, -5.82e-14, -3.88e-14, -1.94e-14, 0.0, 1.94e-14, 3.88e-14, 5.82e-14, 7.76e-14, 9.7e-14]
[0.000715397315, 0.0006796464489999999, 0.00065775752, 0.0006580470925, 0.000665814479, 0.0006890318879999999, 0.0007219787399999999, 0.000778378194, 0.0008378878040000001, 0.000919429332, 0.0010122297570000001]
--------FT5 5000--------
[-9e-16, -7.2e-16, -5.4e-16, -3.6e-16, -1.8e-16, 0.0, 1.8e-16, 3.6e-16, 5.4e-16, 7.2e-16, 9e-16]
[6.72967943e-05, 6.23730093e-05, 5.971211549999999e-05, 5.8547331999999995e-05, 5.921013675e-05, 6.15180017e-05, 6.52729588e-05, 7.072634745e-05, 7.793004075000001e-05, 8.71201905e-05, 9.788486899999998e-05]
--------FT5 7000--------
[-3.4e-16, -2.72e-16, -2.04e-16, -1.36e-16, -6.8e-17, 0.0, 6.8e-17, 1.36e-16, 2.04e-16, 2.72e-16, 3.4e-16]
[4.24547466e-05, 3.685670775e-05, 3.265799958e-05, 3.0314383449999998e-05, 2.994811365e-05, 3.1357245240000004e-05, 3.448346046e-05, 3.918643612e-05, 4.6126908e-05, 5.479735625e-05, 6.478947475e-05]
--------FT5 15000--------
[-2.5e-17, -2e-17, -1.5e-17, -1e-17, -5e-18, 3.081488e-33, 5e-18, 1e-17, 1.5e-17, 2e-17, 2.5e-17]
[1.470524495e-05, 1.126957272e-05, 8.74792385e-06, 7.215301900000001e-06, 6.533650315e-06, 6.818311045000001e-06, 8.03644755e-06, 1.0197873019999998e-05, 1.326129688e-05, 1.741312524e-05, 2.2275870485000003e-05]
--------FT7 1500--------
[-1.9e-13, -1.52e-13, -1.14e-13, -7.6e-14, -3.8e-14, 0.0, 3.8e-14, 7.6e-14, 1.14e-13, 1.52e-13, 1.9e-13]
[0.000647102969, 0.000625410636, 0.0006177416310000001, 0.0006305688, 0.000651799512, 0.00068681951, 0.00073923231, 0.0008031595280000001, 0.0008754934699999999, 0.0009731995000000001, 0.0010808283325]
--------FT7 5000--------
[-1.8e-15, -1.44e-15, -1.08e-15, -7.2e-16, -3.6e-16, 0.0, 3.6e-16, 7.2e-16, 1.08e-15, 1.44e-15, 1.8e-15]
[6.005108035e-05, 5.7034512e-05, 5.56869195e-05, 5.5766713599999994e-05, 5.7554505e-05, 6.15872207e-05, 6.68802463e-05, 7.39820212e-05, 8.30106844e-05, 9.34213986e-05, 0.0001057709349]
--------FT7 7000--------
[-6.9e-16, -5.52e-16, -4.14e-16, -2.76e-16, -1.38e-16, 0.0, 1.38e-16, 2.76e-16, 4.14e-16, 5.52e-16, 6.9e-16]
[3.784738496e-05, 3.276013416e-05, 2.9451113685000002e-05, 2.811037566e-05, 2.8758515239999996e-05, 3.138275904e-05, 3.565590048e-05, 4.212359771e-05, 5.00979948e-05, 6.02610552e-05, 7.22898967e-05]
--------FT7 15000--------
[-4.9e-17, -3.92e-17, -2.94e-17, -1.96e-17, -9.8e-18, 0.0, 9.8e-18, 1.96e-17, 2.94e-17, 3.92e-17, 4.9e-17]
[1.2786123624999998e-05, 9.74108025e-06, 7.62222415e-06, 6.431723490000001e-06, 6.169691675e-06, 6.7937057649999995e-06, 8.397759060000001e-06, 1.0903764599999998e-05, 1.433362413e-05, 1.8696477214999998e-05, 2.400751776e-05]
--------FT8 1500--------
[-1.6e-14, -1.28e-14, -9.6e-15, -6.4e-15, -3.2e-15, 0.0, 3.2e-15, 6.4e-15, 9.6e-15, 1.28e-14, 1.6e-14]
[0.000722305846, 0.00068525924, 0.000658700392, 0.000658042011, 0.00066352286, 0.0006900398439999999, 0.0007278951750000001, 0.000773679235, 0.0008462123799999999, 0.0009289752549999998, 0.00102717466]
--------FT8 5000--------
[-1.4e-16, -1.12e-16, -8.4e-17, -5.6e-17, -2.8e-17, 0.0, 2.8e-17, 5.6e-17, 8.4e-17, 1.12e-16, 1.4e-16]
[6.6199752e-05, 6.166054035e-05, 5.97779028e-05, 5.8408580699999995e-05, 5.9135535e-05, 6.16225993e-05, 6.5456983e-05, 7.06372326e-05, 7.75250745e-05, 8.579287199999999e-05, 9.5613252e-05]
--------FT8 7000--------
[-5.5e-17, -4.4e-17, -3.3e-17, -2.2e-17, -1.1e-17, 0.0, 1.1e-17, 2.2e-17, 3.3e-17, 4.4e-17, 5.5e-17]
[4.247544752e-05, 3.657175256e-05, 3.2589185889999997e-05, 3.0215115404999997e-05, 3.0037464445e-05, 3.1411413000000004e-05, 3.47027725e-05, 3.945195321e-05, 4.643936e-05, 5.494617655000001e-05, 6.53661684e-05]
--------FT8 15000--------
[-3.9e-18, -3.12e-18, -2.34e-18, -1.56e-18, -7.8e-19, 0.0, 7.8e-19, 1.56e-18, 2.34e-18, 3.12e-18, 3.9e-18]
[1.407297315e-05, 1.0870568700000001e-05, 8.58198254e-06, 7.09129476e-06, 6.49738873e-06, 6.82215562e-06, 8.00531545e-06, 1.008299776e-05, 1.300102692e-05, 1.6866924009999998e-05, 2.154662735e-05]
--------FT9 1500--------
[-3.1e-14, -2.48e-14, -1.86e-14, -1.24e-14, -6.2e-15, 0.0, 6.2e-15, 1.24e-14, 1.86e-14, 2.48e-14, 3.1e-14]
[0.0006440253640000001, 0.000621240984, 0.000616586635, 0.0006263942535, 0.0006473548315, 0.000688322902, 0.0007407766269999999, 0.000803316514, 0.0008822284229999999, 0.000983355714, 0.001089309853]
--------FT9 5000--------
[-2.9e-16, -2.32e-16, -1.74e-16, -1.16e-16, -5.8e-17, 4.930381e-32, 5.8e-17, 1.16e-16, 1.74e-16, 2.32e-16, 2.9e-16]
[5.98466438e-05, 5.6360149050000006e-05, 5.534413605e-05, 5.5541525e-05, 5.722685865000001e-05, 6.150185059999999e-05, 6.679632959999999e-05, 7.385966925e-05, 8.3207194e-05, 9.37193544e-05, 0.0001059370576]
--------FT9 7000--------
[-1.1e-16, -8.8e-17, -6.6e-17, -4.4e-17, -2.2e-17, 0.0, 2.2e-17, 4.4e-17, 6.6e-17, 8.8e-17, 1.1e-16]
[3.7402538400000004e-05, 3.2523264725e-05, 2.947672683e-05, 2.811231176e-05, 2.8727592580000004e-05, 3.1252834920000004e-05, 3.569264475e-05, 4.189163265e-05, 5.0004539049999994e-05, 5.9967025650000004e-05, 7.171564215e-05]
--------FT9 15000--------
[-7.9e-18, -6.32e-18, -4.74e-18, -3.16e-18, -1.58e-18, 0.0, 1.58e-18, 3.16e-18, 4.74e-18, 6.32e-18, 7.9e-18]
[1.273884678e-05, 9.736454909999999e-06, 7.630735700000002e-06, 6.3777743e-06, 6.17230536e-06, 6.79481642e-06, 8.428760725e-06, 1.0927068375e-05, 1.4389308225e-05, 1.8922748455e-05, 2.4052290075e-05]

"""
